import { useEffect, useRef, useState } from 'react';
import AOS from 'aos';
import 'aos/dist/aos.css';

const initialMessages = Array.from({ length: 30 }, (_, i) => ({
  id: i,
  text: 'REN主播生日快樂！願你的直播每次都充滿歡笑與宇宙能量。',
  author: `潤黑 ${i + 1} 號`,
}));

export default function BlessingsPage() {
  const observerRef = useRef(null);
  const [visibleCount, setVisibleCount] = useState(12);

  useEffect(() => {
    AOS.init({ duration: 800, once: true });
  }, []);

  useEffect(() => {
    const observer = new IntersectionObserver(
      entries => {
        if (entries[0].isIntersecting && visibleCount < initialMessages.length) {
          setVisibleCount(prev => prev + 6);
        }
      },
      {
        rootMargin: '0px 0px 100px 0px',
      }
    );

    if (observerRef.current) observer.observe(observerRef.current);
    return () => observer.disconnect();
  }, [visibleCount]);

  return (
    <main className="bg-[#0E1018] text-white min-h-screen font-sans">
      {/* Header 導覽列 */}
<header className="w-full bg-black px-6 py-4 flex items-center justify-between sticky top-0 z-50">
  <div className="flex items-center gap-6">
    {/* 點整塊回首頁 */}
    <a href="/" className="flex items-center gap-4 hover:opacity-90 transition">
      <div className="h-10 w-10 rounded bg-gray-500" />
      <div className="text-left">
        <p className="text-sm text-gray-300 leading-tight">REN0809K 2025 生日</p>
        <h1 className="text-xl font-semibold leading-tight">RENKO 火箭任務</h1>
      </div>
    </a>

    {/* 導覽連結 */}
    <nav className="hidden md:flex gap-10 text-white text-base pl-12">
      <a href="#" className="hover:text-[#00B3FF]">關於火箭</a>
      <a href="#" className="hover:text-[#00B3FF]">生日祝福</a>
    </nav>
  </div>

  <a href="#" className="border border-white px-4 py-2 rounded-full text-sm hover:bg-white hover:text-black transition">
    前往 RCOSEA 官網
  </a>
</header>


      {/* 主內容區 */}
      <div className="px-6 py-12">
        {/* 標題區 */}
        <section className="text-center mb-12">
          <h1 className="text-4xl md:text-5xl font-bold text-[#00B3FF] mb-4">#20250809K 留言牆</h1>
          <p className="text-lg text-gray-300 max-w-2xl mx-auto">
            這裡蒐集了來自潤黑們的祝福留言，一起為 REN0809K 的生日寫下紀錄！
          </p>
        </section>

        {/* 留言卡片列表 */}
        <section className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 max-w-6xl mx-auto">
          {initialMessages.slice(0, visibleCount).map((msg, i) => (
            <div
              key={msg.id}
              className="bg-[#162030]/90 backdrop-blur-md border border-[#00B3FF]/40 rounded-xl p-6 text-left shadow hover:shadow-[#7BDFFF]/30 transition"
              data-aos="fade-up"
            >
              <p className="text-base text-[#A6DFFF] mb-4">“{msg.text}”</p>
              <p className="text-sm text-right text-gray-400">- {msg.author}</p>
            </div>
          ))}
        </section>

        {/* IntersectionObserver 觸發區 */}
        <div ref={observerRef} className="h-12" />
      </div>

      {/* Footer 區塊 */}
      <footer className="bg-[#2B2B2E] py-12 px-6 text-center">
        <div className="mb-4">
          <a href="/" className="text-white hover:underline mx-2">回首頁</a>
          <a href="#" className="text-white hover:underline mx-2">關於火箭</a>
          <a href="#" className="text-white hover:underline mx-2">生日祝福</a>
          <a href="#" className="text-white hover:underline mx-2">RCOSEA 官網</a>
        </div>
        <p className="text-sm text-gray-500">Copyright © 2025 Ren 火箭計畫｜by 資訊組</p>
      </footer>
    </main>
  );
}
